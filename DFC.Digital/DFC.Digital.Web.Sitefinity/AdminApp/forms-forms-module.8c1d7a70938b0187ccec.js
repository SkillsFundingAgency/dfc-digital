/*! For license information please see forms-forms-module.8c1d7a70938b0187ccec.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([["forms-forms-module"],{2251:function(e,t,n){"use strict";n.r(t),n.d(t,"SfFormsModule",(function(){return v}));var o=n(229),i=n(313),r=n(261),s=n(415),a=n(2252),l=n(1565),c=n(2260),u=n(2261),f=n(2253),m=n(2262),p=n(2254),d=n(2259),C=n(2256),E=n(2258),h=n(2264),T=n(260),g=n(1218),F=n(1575),I=n(2263),S=[{path:"integrated",children:[{path:"**",component:h.FormsEditIntegratedComponent}]},{path:"rules",component:a.FormRulesListComponent,children:[{path:"confirm/:name",component:g.ModalWindowComponent,outlet:"dialog"}],resolve:{metaStore:F.MetadataStoreResolver}}],v=function(){function e(){}return e.ɵmod=o["ɵɵdefineNgModule"]({type:e}),e.ɵinj=o["ɵɵdefineInjector"]({factory:function(t){return new(t||e)},providers:[f.FormsService,C.FormFieldTypesParserService],imports:[[T.RouterModule.forChild(S),s.FieldsModule,l.SharedModule,i.FormsModule,r.CommonModule],T.RouterModule]}),e}();o["ɵɵsetNgModuleScope"](v,{declarations:[a.FormRulesListComponent,c.ConditionColumnComponent,u.ActionColumnComponent,p.FormRuleCreateComponent,d.ConditionCreateCompositeComponent,E.ActionCreateCompositeComponent,h.FormsEditIntegratedComponent,c.GetConditionFieldTitlePipe,c.GetConditionOperatorLabelPipe,c.GetConditionFieldValuePipe,c.GetRuleOperatorLabelPipe,m.FormActionColumnDirective,I.TrimTextPipe],imports:[T.RouterModule,s.FieldsModule,l.SharedModule,i.FormsModule,r.CommonModule],exports:[T.RouterModule]})},2252:function(e,t,n){"use strict";n.r(t),n.d(t,"FormRulesListComponent",(function(){return Q}));var o=n(259),i=n(229),r=n(1164),s=n(308),a=n(2253),l=n(1534),c=n(246),u=n(1119),f=n(2254),m=n(260),p=n(2255),d=n(268),C=n(344),E=n(256),h=n(263),T=n(245),g=n(1141),F=n(131),I=n(1061),S=n(1139),v=n(396),D=n(11),_=n(261),O=n(347),R=n(345),A=n(352),y=n(1515),P=n(1516),N=n(2260),x=n(2261),w=n(346),M=["navigationMenuTemplate"];function L(e,t){1&e&&(i["ɵɵelementStart"](0,"h3",7),i["ɵɵtext"](1,"Form rules"),i["ɵɵelementEnd"]())}function b(e,t){1&e&&(i["ɵɵelementStart"](0,"p",18),i["ɵɵtext"](1,"No rules have been created yet"),i["ɵɵelementEnd"]())}function V(e,t){1&e&&(i["ɵɵelementStart"](0,"p",18),i["ɵɵtext"](1,"You cannot create rules for an empty form"),i["ɵɵelementEnd"]())}function k(e,t){if(1&e){var n=i["ɵɵgetCurrentView"]();i["ɵɵelementStart"](0,"sf-button",19),i["ɵɵlistener"]("click",(function(){return i["ɵɵrestoreView"](n),i["ɵɵnextContext"](3).createRule(null)})),i["ɵɵtext"](1,"Create a rule"),i["ɵɵelementEnd"]()}}function G(e,t){if(1&e&&(i["ɵɵelementStart"](0,"div",10),i["ɵɵelementStart"](1,"div",11),i["ɵɵelementStart"](2,"h1",12),i["ɵɵtext"](3),i["ɵɵelementEnd"](),i["ɵɵelementEnd"](),i["ɵɵelementStart"](4,"div",13),i["ɵɵelement"](5,"sf-icon",14),i["ɵɵtemplate"](6,b,2,0,"p",15),i["ɵɵtemplate"](7,V,2,0,"p",15),i["ɵɵelementEnd"](),i["ɵɵelementStart"](8,"div",16),i["ɵɵtemplate"](9,k,2,0,"sf-button",17),i["ɵɵelementEnd"](),i["ɵɵelementEnd"]()),2&e){var n=i["ɵɵnextContext"](2);i["ɵɵadvance"](3),i["ɵɵtextInterpolate"](n.formDefinition.Title),i["ɵɵadvance"](3),i["ɵɵproperty"]("ngIf",n.hasFields),i["ɵɵadvance"](1),i["ɵɵproperty"]("ngIf",!n.hasFields),i["ɵɵadvance"](2),i["ɵɵproperty"]("ngIf",n.hasFields)}}function Y(e,t){1&e&&(i["ɵɵelementStart"](0,"b"),i["ɵɵtext"](1,"IF"),i["ɵɵelementEnd"]())}function U(e,t){if(1&e&&i["ɵɵelement"](0,"sf-condition-column",30),2&e){var n=t.context,o=i["ɵɵnextContext"](3);i["ɵɵproperty"]("formRuleConditions",n.data.Conditions)("formRuleOperator",n.data.Operator)("formDefinition",o.formDefinition)}}function H(e,t){1&e&&(i["ɵɵelementStart"](0,"b"),i["ɵɵtext"](1,"THEN"),i["ɵɵelementEnd"]())}function j(e,t){if(1&e&&i["ɵɵelement"](0,"sf-action-column",31),2&e){var n=t.context,o=i["ɵɵnextContext"](3);i["ɵɵproperty"]("formRuleActions",n.data.Actions)("formDefinition",o.formDefinition)}}var B=function(e){return{"-sf-disabled":e}};function X(e,t){if(1&e){var n=i["ɵɵgetCurrentView"]();i["ɵɵelementStart"](0,"sf-icon",32),i["ɵɵlistener"]("click",(function(){i["ɵɵrestoreView"](n);var e=t.context;return i["ɵɵnextContext"](3).deleteRule(e)})),i["ɵɵelementEnd"]()}if(2&e){var o=i["ɵɵnextContext"](3);i["ɵɵproperty"]("ngClass",i["ɵɵpureFunction1"](1,B,!o.canUpdate))}}function K(e,t){if(1&e){var n=i["ɵɵgetCurrentView"]();i["ɵɵelementStart"](0,"div",20),i["ɵɵelementStart"](1,"div",11),i["ɵɵelementStart"](2,"h1",12),i["ɵɵtext"](3),i["ɵɵelementEnd"](),i["ɵɵelementEnd"](),i["ɵɵelementStart"](4,"div",21),i["ɵɵelementStart"](5,"sf-button",22),i["ɵɵlistener"]("click",(function(){return i["ɵɵrestoreView"](n),i["ɵɵnextContext"](2).createRule(null)})),i["ɵɵtext"](6,"Create a rule"),i["ɵɵelementEnd"](),i["ɵɵelementEnd"](),i["ɵɵelementEnd"](),i["ɵɵelementStart"](7,"sf-notification",23),i["ɵɵtext"](8," Rules will be active on the site after you publish the form. "),i["ɵɵelementEnd"](),i["ɵɵelementStart"](9,"sf-list",24),i["ɵɵlistener"]("itemSelectionChanged",(function(e){return i["ɵɵrestoreView"](n),i["ɵɵnextContext"](2).createRule(e)})),i["ɵɵtemplate"](10,Y,2,0,"ng-template",25),i["ɵɵtemplate"](11,U,1,3,"ng-template",26),i["ɵɵtemplate"](12,H,2,0,"ng-template",27),i["ɵɵtemplate"](13,j,1,2,"ng-template",28),i["ɵɵtemplate"](14,X,1,3,"ng-template",29),i["ɵɵelementEnd"]()}if(2&e){var o=i["ɵɵnextContext"](2);i["ɵɵadvance"](3),i["ɵɵtextInterpolate"](o.formDefinition.Title),i["ɵɵadvance"](6),i["ɵɵproperty"]("itemsState",o.stateWrapper)("shouldHideHeader",o.shouldHideHeader)("treeConfig",o.treeConfig)("ignoreLoaderDelay",!0)}}function W(e,t){if(1&e&&(i["ɵɵelementContainerStart"](0),i["ɵɵtemplate"](1,G,10,4,"div",8),i["ɵɵtemplate"](2,K,15,5,"ng-template",null,9,i["ɵɵtemplateRefExtractor"]),i["ɵɵelementContainerEnd"]()),2&e){var n=i["ɵɵreference"](3),o=i["ɵɵnextContext"]();i["ɵɵadvance"](1),i["ɵɵproperty"]("ngIf",!o.stateWrapper.hasItems)("ngIfElse",n)}}function z(e,t){1&e&&(i["ɵɵelementStart"](0,"div",35),i["ɵɵelementStart"](1,"div",36),i["ɵɵelement"](2,"sf-loader",37),i["ɵɵelementEnd"](),i["ɵɵelementEnd"]())}var q=function(){return[0,0,0,0,0,0,0,0,0,0]};function Z(e,t){1&e&&(i["ɵɵelementStart"](0,"div",33),i["ɵɵtemplate"](1,z,3,0,"div",34),i["ɵɵelementEnd"]()),2&e&&(i["ɵɵadvance"](1),i["ɵɵproperty"]("ngForOf",i["ɵɵpureFunction0"](1,q)))}var Q=function(e){function t(t,n,o,i,s,a,l){var c=e.call(this)||this;return c.formsService=t,c.metadataStore=n,c.modalService=o,c.route=i,c.router=s,c.document=a,c.siteData=l,c.shouldHideHeader=!0,c.stateWrapper=r.StateWrapper.empty(),c.canUpdate=!0,c.isInitialRulesLoadComplete=!1,c.hasFields=!1,c}return Object(o.__extends)(t,e),t.prototype.ngOnInit=function(){var e=this;this.toggleEditFormControlCssClass(),this.route.queryParamMap.pipe(Object(F.flatMap)((function(t){return e.formId=t.get("id"),e.culture=t.get("culture")||c.stringConstants.EMPTY_STRING,e.siteData.getValue()})),Object(F.flatMap)((function(t){return e.culture=e.culture||t.DefaultContentCulture,e.formsService.getFormDefinition(e.formId,e.culture)})),Object(I.toLoadingState)(),Object(I.delayEmission)(S.MINIMUM_LOADER_TIME)).subscribe((function(t){if(!t.isLoading)try{var n=t.content;e.formDefinition=Object(T.cloneObject)(n.data),e.formDefinition.Rules=e.getFormRules(),e.formDefinition.Culture=e.culture,e.propagateRules(!1),e.hasFields=e.formDefinition.Fields&&e.formDefinition.Fields.length>0,e.isInitialRulesLoadComplete=!0}catch(t){e.handleFormRuleFetchError(t)}}),(function(t){e.handleFormRuleFetchError(t)})),this.navbarConfiguration={mode:l.NavbarModes.OneColumn,leftNavbarButtonData:{show:!0,look:"toggle",icon:"angle-left",iconLook:"size-2xl",mode:l.LeftNavbarButtonMode.Back,title:p.FormsConstants.BACK_TO_FORMS},isScrollEnabled:!1,look:c.stringConstants.EMPTY_STRING,templates:[this.navigationMenuTemplate]},this.treeConfig={noSelection:!0}},t.prototype.ngOnDestroy=function(){this.toggleEditFormControlCssClass(!1)},t.prototype.createRule=function(e){var t=this,n=e?e.data:null,o=e?this.stateWrapper.dataItems.indexOf(e):-1,i=e?Object(T.cloneObject)(n):null,r={type:f.FormRuleCreateComponent,afterComponentInit:function(n){n.title=e?p.FormsConstants.EDIT_A_RULE:p.FormsConstants.CREATE_A_RULE,n.formDefinition=t.formDefinition,n.formRule=i}},s=[new u.ConfirmButton(p.FormsConstants.CREATE_THIS_RULE,(function(e){return t.saveFormRulehandler(e,o)})),new u.CancelButton(p.FormsConstants.CANCEL)];e&&(s=[new u.ConfirmButton(p.FormsConstants.SAVE_THIS_RULE,(function(e){return t.saveFormRulehandler(e,o)})),new u.CancelButton(p.FormsConstants.CANCEL)]);var a=new u.DialogData(r,(function(e){}),s,null);this.modalService.setMapping(a,p.FormsConstants.ROUTES.CREATE_FORM_RULE_DIALOG),this.modalService.show(p.FormsConstants.ROUTES.CREATE_FORM_RULE_DIALOG,this.route)},t.prototype.saveFormRulehandler=function(e,t){var n=this,o=new D.ReplaySubject(1);o.next(new u.ClickResult(!0,!1));var i=e.component.formRule;return i&&(i.Actions.forEach((function(e){e.Action===p.FormsConstants.FORM_ACTION_TYPE.SEND_NOTIFICATION&&(e.Target=e.Target.trim().split("\n").filter((function(e){return e!==c.stringConstants.EMPTY_STRING})).map((function(e){return e.trim()})).join(","))})),t>=0?this.formDefinition.Rules.splice(t,1,i):this.formDefinition.Rules.push(i),this.propagateRules(!1),this.canUpdate=!1,this.formsService.updateRules(this.formDefinition).subscribe((function(e){n.canUpdate=!0,o.next(new u.ClickResult(!0,!0,!1,!1))}))),o},t.prototype.getFormRules=function(){var e=this,t=[];return this.formDefinition.Rules.forEach((function(n){var o=[];n.Conditions.forEach((function(t){e.findFormField(t.Id)&&o.push(t)}));var i=[];n.Actions.forEach((function(t){switch(t.Action){case p.FormsConstants.FORM_ACTION_TYPE.SHOW:case p.FormsConstants.FORM_ACTION_TYPE.HIDE:e.findFormField(t.Target)&&i.push(t);break;case p.FormsConstants.FORM_ACTION_TYPE.SKIP:e.findFormStep(t.Target)&&i.push(t);break;default:i.push(t)}})),o.length>0&&i.length>0&&(n.Conditions=o,n.Actions=i,t.push(n))})),t},t.prototype.findFormField=function(e){return this.formDefinition.Fields.find((function(t){return t.Id===e}))},t.prototype.findFormStep=function(e){return this.formDefinition.Steps.find((function(t){return t.Key===e}))},t.prototype.onNavigateBack=function(){this.document.dispatchEvent(new Event(p.FormsConstants.ROUTES.SITEFINITY_OLD_BACKEND_REFRESH_RULES_EVENT_NAME)),this.router.navigate([v.ROUTE_PATHS.CONTENT,v.ROUTE_PATHS_NO_PREFIX.FORMS,p.FormsConstants.ROUTES.INTEGRATED,this.formDefinition.Name])},t.prototype.propagateRules=function(e){var t=this,n=this.metadataStore.getEntity(E.ENTITY_SET.FORM_DRAFTS),o=[];this.formDefinition.Rules.forEach((function(e){o.push(s.DataItem.from(e,n,null,null))})),this.stateWrapper=r.StateWrapper.wrap({dataItems:o,totalCount:o.length}),e&&(this.canUpdate=!1,this.formsService.updateRules(this.formDefinition).subscribe((function(e){t.canUpdate=!0})))},t.prototype.deleteRule=function(e){var t=this.stateWrapper.dataItems.indexOf(e);t>=0&&this.formDefinition.Rules.splice(t,1),this.propagateRules(!0)},t.prototype.toggleEditFormControlCssClass=function(e){void 0===e&&(e=!0),e?(Object(T.toggleIrisIntegratedStyles)(!0),this.document.body.classList.add(p.FormsConstants.ROUTES.ADMIN_APP_CONTROL_CLASS)):(Object(T.toggleIrisIntegratedStyles)(!1),this.document.body.classList.remove(p.FormsConstants.ROUTES.ADMIN_APP_CONTROL_CLASS))},t.prototype.handleFormRuleFetchError=function(e){throw new Error("An error occurred during fetching the form rules. "+e)},t.ɵfac=function(e){return new(e||t)(i["ɵɵdirectiveInject"](a.FormsService),i["ɵɵdirectiveInject"](d.MetadataStore),i["ɵɵdirectiveInject"](u.ModalWindowService),i["ɵɵdirectiveInject"](m.ActivatedRoute),i["ɵɵdirectiveInject"](m.Router),i["ɵɵdirectiveInject"](C.DOCUMENT_TOKEN),i["ɵɵdirectiveInject"](g.SiteDataStore))},t.ɵcmp=i["ɵɵdefineComponent"]({type:t,selectors:[["ng-component"]],viewQuery:function(e,t){if(1&e&&i["ɵɵstaticViewQuery"](M,!0),2&e){var n;i["ɵɵqueryRefresh"](n=i["ɵɵloadQuery"]())&&(t.navigationMenuTemplate=n.first)}},features:[i["ɵɵInheritDefinitionFeature"]],decls:9,vars:3,consts:[["name","dialog"],[1,"sf-wrapper","-list","sf-router-wrapper"],[1,"sf-main","-list"],[3,"configuration","leftNavButtonClick"],["navigationMenuTemplate",""],[4,"ngIf","ngIfElse"],["loading",""],[1,"-sf-ml-xs"],["class","-align-items-center -sf-mt-6xl -sf-txt-align-center ng-star-inserted",4,"ngIf","ngIfElse"],["itemsList",""],[1,"-align-items-center","-sf-mt-6xl","-sf-txt-align-center","ng-star-inserted"],[1,"sf-row__col","-auto-flex"],[1,"-sf-fade-in"],[1,"-sf-mt-6xl","-sf-mb-6xl"],["name","file-text-o","look","illustrative"],["class","-sf-txt-hint -sf-mt-xs",4,"ngIf"],[1,"sf-row__col","-no-flex","-sf-mb-2xs"],["iconlook","size-xs","look","action large sf-mr-zero","icon-look","size-xs",3,"click",4,"ngIf"],[1,"-sf-txt-hint","-sf-mt-xs"],["iconlook","size-xs","look","action large sf-mr-zero","icon-look","size-xs",3,"click"],[1,"sf-row","-sf-mb-m","sf-main__header"],[1,"sf-row__col","-no-flex"],["iconlook","size-xs","look","action","icon-look","size-xs",3,"click"],["look","small inline sf-mb-m"],[1,"-sf-txt-large",3,"itemsState","shouldHideHeader","treeConfig","ignoreLoaderDelay","itemSelectionChanged"],["sfColumnTemplate","","name","if","class","-fluid","clickable","true"],["sfColumnTemplate","","name","condition","class","-fill","clickable","true"],["sfColumnTemplate","","name","then","clickable","true","class","-fluid"],["sfColumnTemplate","","name","result","class","-fill","clickable","true"],["sfColumnTemplate","","name","delete","class","-col-size-3xs -sf-txt-align-right"],[3,"formRuleConditions","formRuleOperator","formDefinition"],[3,"formRuleActions","formDefinition"],["look","size-3xs sf-clickable","name","times",3,"ngClass","click"],[1,"-sf-mt-6xl"],["class","sf-tree-list__row -loading",4,"ngFor","ngForOf"],[1,"sf-tree-list__row","-loading"],[1,"sf-tree-list__cell"],["look","skeleton list"]],template:function(e,t){if(1&e&&(i["ɵɵelement"](0,"router-outlet",0),i["ɵɵelementStart"](1,"div",1),i["ɵɵelementStart"](2,"main",2),i["ɵɵelementStart"](3,"sf-navigation-menu",3),i["ɵɵlistener"]("leftNavButtonClick",(function(){return t.onNavigateBack()})),i["ɵɵelementEnd"](),i["ɵɵtemplate"](4,L,2,0,"ng-template",null,4,i["ɵɵtemplateRefExtractor"]),i["ɵɵtemplate"](6,W,4,2,"ng-container",5),i["ɵɵtemplate"](7,Z,2,2,"ng-template",null,6,i["ɵɵtemplateRefExtractor"]),i["ɵɵelementEnd"](),i["ɵɵelementEnd"]()),2&e){var n=i["ɵɵreference"](8);i["ɵɵadvance"](3),i["ɵɵproperty"]("configuration",t.navbarConfiguration),i["ɵɵadvance"](3),i["ɵɵproperty"]("ngIf",t.isInitialRulesLoadComplete)("ngIfElse",n)}},directives:[m.RouterOutlet,l.NavigationMenuComponent,_.NgIf,O.SfIconComponent,R.ButtonComponent,A.NotificationComponent,y.ListComponent,P.ListColumnDirective,N.ConditionColumnComponent,x.ActionColumnComponent,_.NgClass,_.NgForOf,w.LoaderComponent],encapsulation:2}),t}(h.RxBaseComponent)},2253:function(e,t,n){"use strict";n.r(t),n.d(t,"FormsService",(function(){return l}));var o=n(229),i=n(268),r=n(307),s=n(246),a=n(256),l=function(){function e(e,t){this.metadataStore=e,this.dynamicItemsService=t}return e.prototype.getFormDefinition=function(e,t){void 0===t&&(t=s.stringConstants.EMPTY_STRING);var n={itemKey:e,action:"Default.GetTempForm()",entityData:{metadata:this.metadataStore.getEntity(a.ENTITY_SET.FORM_DRAFTS),culture:t}};return this.dynamicItemsService.getItem(n)},e.prototype.updateRules=function(e){var t={metadata:this.metadataStore.getEntity(a.ENTITY_SET.FORM_DRAFTS),provider:s.stringConstants.EMPTY_STRING,culture:e.Culture};return this.dynamicItemsService.executeEntityOperationForDataItemKey(e.Id,t,"Default.SaveTempForm()",{rules:e.Rules})},e.ɵfac=function(t){return new(t||e)(o["ɵɵinject"](i.MetadataStore),o["ɵɵinject"](r.DynamicItemService))},e.ɵprov=o["ɵɵdefineInjectable"]({token:e,factory:e.ɵfac}),e}()},2254:function(e,t,n){"use strict";n.r(t),n.d(t,"FormRuleCreateComponent",(function(){return T}));var o=n(229),i=n(1145),r=n(2255),s=n(246),a=n(2256),l=n(2258),c=n(368),u=n(1176),f=n(1144),m=n(261),p=n(345),d=n(2259),C=function(e){return{"-sf-mb-xs":e}};function E(e,t){if(1&e){var n=o["ɵɵgetCurrentView"]();o["ɵɵelementStart"](0,"sf-condition-create-composite",11),o["ɵɵlistener"]("conditionForDelete",(function(e){return o["ɵɵrestoreView"](n),o["ɵɵnextContext"]().deleteCondition(e)})),o["ɵɵelementEnd"]()}if(2&e){var i=t.$implicit,r=t.last,s=o["ɵɵnextContext"]();o["ɵɵproperty"]("formDefinition",s.formDefinition)("formRuleCondition",i)("canDelete",s.formRule.Conditions.length>1)("ngClass",o["ɵɵpureFunction1"](4,C,!r))}}function h(e,t){if(1&e){var n=o["ɵɵgetCurrentView"]();o["ɵɵelementStart"](0,"sf-action-create-composite",12),o["ɵɵlistener"]("actionForDelete",(function(e){return o["ɵɵrestoreView"](n),o["ɵɵnextContext"]().deleteAction(e)})),o["ɵɵelementEnd"]()}if(2&e){var i=t.$implicit,r=t.last,s=o["ɵɵnextContext"]();o["ɵɵproperty"]("formDefinition",s.formDefinition)("formRuleAction",i)("canDelete",s.formRule.Actions.length>1)("ngClass",o["ɵɵpureFunction1"](4,C,!r))}}var T=function(){function e(e,t){this.typeParserService=e,this.scrollService=t}return e.prototype.ngOnInit=function(){this.formRule||(this.formRule={Operator:r.FormRuleOperatorCRUD.Any,Conditions:[this.generateCondition()],Actions:[this.generateAction()]}),this.operatorDropdownSettings=new i.ChoiceSettings("operatorDropdown",!1),this.operatorDropdownSettings.choices=this.generateChoices(),this.formRule&&(this.operatorDropdownSettings.defaultValue=this.formRule.Operator)},e.prototype.canCloseCallback=function(e){var t=!0;return e.data&&e.data.data&&this.actionComponents.forEach((function(e){t=e.isValid()&&t})),t},e.prototype.addCondition=function(){this.formRule.Conditions.push(this.generateCondition())},e.prototype.deleteCondition=function(e){var t=this.formRule.Conditions.indexOf(e);this.formRule.Conditions.splice(t,1)},e.prototype.addAction=function(){this.formRule.Actions.push(this.generateAction())},e.prototype.deleteAction=function(e){var t=this.formRule.Actions.indexOf(e);this.formRule.Actions.splice(t,1)},e.prototype.formOperatorChanged=function(e){this.formRule.Operator=e},e.prototype.generateCondition=function(){var e={Id:s.stringConstants.EMPTY_STRING,Operator:s.stringConstants.EMPTY_STRING,Value:s.stringConstants.EMPTY_STRING},t=this.typeParserService.getConditionFields(this.formDefinition)[0];if(t){e.Id=t.Id;var n=t.Operators[0];n&&(e.Operator=n.Key),e.Value=this.getDefaultFieldValue(t)}return e},e.prototype.generateAction=function(){var e={Action:s.stringConstants.EMPTY_STRING,Target:s.stringConstants.EMPTY_STRING};this.formDefinition.AvailableActions[0]&&(e.Action=this.formDefinition.AvailableActions[0].Key);var t=this.typeParserService.getActionFields(this.formDefinition)[0];return t&&(e.Target=t.Id),e},e.prototype.generateChoices=function(){var e=[];return Object.keys(r.FormRuleOperatorCRUD).forEach((function(t){e.push({Value:r.FormRuleOperatorCRUD[t],Name:t})})),e},e.prototype.getDefaultFieldValue=function(e){var t=s.stringConstants.EMPTY_STRING;return e.Values.length>0&&(t=e.Values[0]),t},e.ɵfac=function(t){return new(t||e)(o["ɵɵdirectiveInject"](a.FormFieldTypesParserService),o["ɵɵdirectiveInject"](c.ScrollService))},e.ɵcmp=o["ɵɵdefineComponent"]({type:e,selectors:[["sf-form-rule-create"]],viewQuery:function(e,t){if(1&e&&o["ɵɵviewQuery"](l.ActionCreateCompositeComponent,!0),2&e){var n;o["ɵɵqueryRefresh"](n=o["ɵɵloadQuery"]())&&(t.actionComponents=n)}},inputs:{title:"title",formDefinition:"formDefinition",formRule:"formRule"},decls:20,vars:4,consts:[[1,"sf-form","-sf-centered-box"],[3,"heading"],[1,"-sf-txt-align-left"],[1,"sf-field","sf-row","-align-items-center"],[1,"sf-field__label"],[1,"-sf-ml-3xs","-sf-mr-3xs","-sf-txt-large",3,"settings","selectionChange"],[1,"sf-field"],[1,"sf-field__content","-sf-mb-3xs"],["class","-sf-block",3,"formDefinition","formRuleCondition","canDelete","ngClass","conditionForDelete",4,"ngFor","ngForOf"],["look","circle small sf-mb-4xs","icon","plus","iconLook","size-xs",3,"onClick"],["class","-sf-block",3,"formDefinition","formRuleAction","canDelete","ngClass","actionForDelete",4,"ngFor","ngForOf"],[1,"-sf-block",3,"formDefinition","formRuleCondition","canDelete","ngClass","conditionForDelete"],[1,"-sf-block",3,"formDefinition","formRuleAction","canDelete","ngClass","actionForDelete"]],template:function(e,t){1&e&&(o["ɵɵelementStart"](0,"div",0),o["ɵɵelement"](1,"sf-sticky-component",1),o["ɵɵelementStart"](2,"div",2),o["ɵɵelementStart"](3,"div",3),o["ɵɵelementStart"](4,"label",4),o["ɵɵtext"](5,"IF"),o["ɵɵelementEnd"](),o["ɵɵelementStart"](6,"sf-dropdown-choice",5),o["ɵɵlistener"]("selectionChange",(function(e){return t.formOperatorChanged(e)})),o["ɵɵelementEnd"](),o["ɵɵelementStart"](7,"b",4),o["ɵɵtext"](8,"of the following conditions are met"),o["ɵɵelementEnd"](),o["ɵɵelementEnd"](),o["ɵɵelementStart"](9,"div",6),o["ɵɵelementStart"](10,"div",7),o["ɵɵtemplate"](11,E,1,6,"sf-condition-create-composite",8),o["ɵɵelementEnd"](),o["ɵɵelementStart"](12,"sf-button",9),o["ɵɵlistener"]("onClick",(function(){return t.addCondition()})),o["ɵɵelementEnd"](),o["ɵɵelementEnd"](),o["ɵɵelementStart"](13,"div",6),o["ɵɵelementStart"](14,"label",4),o["ɵɵtext"](15,"THEN..."),o["ɵɵelementEnd"](),o["ɵɵelementStart"](16,"div",7),o["ɵɵtemplate"](17,h,1,6,"sf-action-create-composite",10),o["ɵɵelementEnd"](),o["ɵɵelementStart"](18,"sf-button",9),o["ɵɵlistener"]("onClick",(function(){return t.addAction()})),o["ɵɵelementEnd"](),o["ɵɵelementEnd"](),o["ɵɵelementEnd"](),o["ɵɵelement"](19,"hr"),o["ɵɵelementEnd"]()),2&e&&(o["ɵɵadvance"](1),o["ɵɵproperty"]("heading",t.title),o["ɵɵadvance"](5),o["ɵɵproperty"]("settings",t.operatorDropdownSettings),o["ɵɵadvance"](5),o["ɵɵproperty"]("ngForOf",t.formRule.Conditions),o["ɵɵadvance"](6),o["ɵɵproperty"]("ngForOf",t.formRule.Actions))},directives:[u.StickyComponent,f.ChoiceDropdownComponent,m.NgForOf,p.ButtonComponent,d.ConditionCreateCompositeComponent,m.NgClass,l.ActionCreateCompositeComponent],encapsulation:2}),e}()},2255:function(e,t,n){"use strict";var o,i;n.r(t),n.d(t,"FormRuleOperatorList",(function(){return o})),n.d(t,"FormRuleOperatorCRUD",(function(){return i})),n.d(t,"FormsConstants",(function(){return r})),function(e){e.Or="or",e.And="and"}(o||(o={})),function(e){e.Any="Or",e.All="And"}(i||(i={}));var r=function(){function e(){}return e.CREATE_A_RULE="Create a rule",e.EDIT_A_RULE="Edit a rule",e.CREATE_THIS_RULE="Create this rule",e.SAVE_THIS_RULE="Save this rule",e.CANCEL="Cancel",e.BACK_TO_FORMS="Back to Forms in Sitefinity",e.MESSAGE="message",e.EMAIL_ADDRESS="email address",e.PAGE="page",e.PAGE_DOES_NOT_EXIST="Selected page does not exist",e.INPUT_PLACEHOLDER="type field value...",e.SELECTED_PAGE_DOES_NOT_EXIST="Selected page doesn't exist anymore.",e.SHOW_HIDE_TOOLTIP_TITLE="Show or hide fields",e.SHOW_HIDE_TOOLTIP_MESSAGE="You can show a field only if it has already been hidden. If you want a form field to be hidden by default when the page loads, you can configure this from the form edit screen.",e.SEND_NOTIFICATION={TEXT_AREA:{INSTRUCTIONAL_TEXT:"Enter email addresses, one per line.",PLACEHOLDER:"email@example.com"}},e.ROUTES={RULES:"rules",INTEGRATED:"integrated",CREATE_FORM_RULE_DIALOG:"CreateFormRule",SITEFINITY_OLD_BACKEND_EDIT_FORM_RULE_EVENT_NAME:"edit-form-rule",SITEFINITY_OLD_BACKEND_REFRESH_RULES_EVENT_NAME:"refresh_form_rules",ADMIN_APP_CONTROL_CLASS:"sfAdminAppControl"},e.STATIC_FORM_FIELDS=["PageBreak","Captcha","SectionHeader","FormNavigation","Hidden","Submit"],e.CONDITION_OPERATORS={Equal:"Equal",NotEqual:"NotEqual",Contains:"Contains",NotContains:"NotContains",IsFilled:"IsFilled",IsNotFilled:"IsNotFilled",IsLessThan:"IsLessThan",IsGreaterThan:"IsGreaterThan",FileSelected:"FileSelected",FileNotSelected:"FileNotSelected"},e.FORM_FIELD_TYPE={TEXTBOX:"Textbox",PARAGRAPH:"Paragraph",MULTIPLE_CHOICE:"MultipleChoice",CHECKBOX:"Checkbox",DROPDOWN:"DropDown",FILE_UPLOAD:"FileUpload"},e.FORM_ACTION_TYPE={SHOW:"Show",HIDE:"Hide",SKIP:"Skip",GOTO:"GoTo",SHOW_MESSAGE:"ShowMessage",SEND_NOTIFICATION:"SendNotification"},e.TEXT_INPUT_TYPE={DATE:"Date",MONTH:"Month",TIME:"Time",DATE_TIME:"DateTime",DATE_TIME_LOCAL:"DateTimeLocal",WEEK:"Week",RANGE:"Range",COLOR:"Color",NUMBER:"Number"},e.TIMEZONE_OFFSET=0,e}()},2256:function(e,t,n){"use strict";n.r(t),n.d(t,"FormFieldTypesParserService",(function(){return R}));var o=n(229),i=n(343),r=n(1144),s=n(1145),a=n(2255),l=n(1239),c=n(1768),u=n(1399),f=n(1663),m=n(1380),p=n(1696),d=n(1118),C=n(322),E=n(321),h=n(1241),T=n(268),g=n(307),F=n(256),I=n(11),S=n(246),v=n(245),D=n(2257),_=n(313),O=n(327),R=function(){function e(e,t){this.metadataStore=e,this.dynamicItemsService=t}return e.prototype.getConditionComponentType=function(e,t){var n=new c.DateTimePickerSettings("dateTimePicker",!1);switch(n.readOnlyMode=!1,e.Type){case a.FormsConstants.FORM_FIELD_TYPE.TEXTBOX:case a.FormsConstants.FORM_FIELD_TYPE.PARAGRAPH:switch(e.InputType){case a.FormsConstants.TEXT_INPUT_TYPE.DATE:return{component:{type:l.DateTimePickerComponent,updatePropertiesOnChange:!0,properties:{timeZoneOffset:a.FormsConstants.TIMEZONE_OFFSET,hideSelectIcon:!0,showTime:!1,settings:n,value:t}}};case a.FormsConstants.TEXT_INPUT_TYPE.MONTH:return{component:{type:l.DateTimePickerComponent,updatePropertiesOnChange:!0,properties:{timeZoneOffset:a.FormsConstants.TIMEZONE_OFFSET,hideSelectIcon:!0,dateBottomView:h.DateTimePickerConstants.VIEW.YEAR,dateTopView:h.DateTimePickerConstants.VIEW.DECADE,dateFormat:h.DateTimePickerConstants.MONTH_FORMAT,showTime:!1,settings:n,value:t}}};case a.FormsConstants.TEXT_INPUT_TYPE.TIME:return{component:{type:l.DateTimePickerComponent,updatePropertiesOnChange:!0,properties:{timeZoneOffset:a.FormsConstants.TIMEZONE_OFFSET,hideSelectIcon:!0,showDate:!1,settings:n,value:t}}};case a.FormsConstants.TEXT_INPUT_TYPE.DATE_TIME:case a.FormsConstants.TEXT_INPUT_TYPE.DATE_TIME_LOCAL:return{component:{type:l.DateTimePickerComponent,updatePropertiesOnChange:!0,properties:{timeZoneOffset:a.FormsConstants.TIMEZONE_OFFSET,hideSelectIcon:!0,showDate:!0,showTime:!0,settings:n,value:t}}};case a.FormsConstants.TEXT_INPUT_TYPE.RANGE:return{component:{type:i.InputComponent,updatePropertiesOnChange:!0,properties:{value:t,type:a.FormsConstants.TEXT_INPUT_TYPE.NUMBER,placeholder:a.FormsConstants.INPUT_PLACEHOLDER}},cssClassList:"sf-row__col"};case a.FormsConstants.TEXT_INPUT_TYPE.COLOR:return{component:{type:i.InputComponent,updatePropertiesOnChange:!0,properties:{value:t,type:a.FormsConstants.TEXT_INPUT_TYPE.COLOR,placeholder:a.FormsConstants.INPUT_PLACEHOLDER}},cssClassList:"sf-row__col -col-1"};case a.FormsConstants.TEXT_INPUT_TYPE.WEEK:return{component:{type:i.InputComponent,updatePropertiesOnChange:!0,properties:{value:t,type:a.FormsConstants.TEXT_INPUT_TYPE.WEEK,placeholder:a.FormsConstants.INPUT_PLACEHOLDER}}};default:return{component:{type:i.InputComponent,updatePropertiesOnChange:!0,properties:{value:t,type:e.InputType,placeholder:a.FormsConstants.INPUT_PLACEHOLDER}},cssClassList:"sf-row__col"}}case a.FormsConstants.FORM_FIELD_TYPE.MULTIPLE_CHOICE:case a.FormsConstants.FORM_FIELD_TYPE.CHECKBOX:case a.FormsConstants.FORM_FIELD_TYPE.DROPDOWN:var o=new s.ChoiceSettings("choiceDropdownComponent",!1);return e.Values.forEach((function(e){o.choices.push({Value:e,Name:e})})),t?o.defaultValue=t:e.Values.length>0&&(o.defaultValue=e.Values[0]),{component:{type:r.ChoiceDropdownComponent,updatePropertiesOnChange:!0,properties:{settings:o}},cssClassList:"sf-row__col"};default:var f=new E.SettingsBase("hiddenComponent",!1);return{component:{type:u.HiddenComponent,properties:{settings:f}},cssClassList:"sf-row__col"}}},e.prototype.getActionComponentType=function(e,t,n){var o,l=this;switch(e){case a.FormsConstants.FORM_ACTION_TYPE.SHOW:case a.FormsConstants.FORM_ACTION_TYPE.HIDE:var c=new s.ChoiceSettings("formTargetDropdown",!1);return this.getActionFields(t).forEach((function(e){c.choices.push({Value:e.Id,Name:e.Title})})),n?c.defaultValue=n:t.Fields.length>0&&(c.defaultValue=t.Fields[0].Id),o={component:{type:r.ChoiceDropdownComponent,updatePropertiesOnChange:!0,properties:{settings:c}},tooltip:{title:a.FormsConstants.SHOW_HIDE_TOOLTIP_TITLE,message:a.FormsConstants.SHOW_HIDE_TOOLTIP_MESSAGE}},Object(I.of)(o);case a.FormsConstants.FORM_ACTION_TYPE.SKIP:var u=new s.ChoiceSettings("formActionsDropdown",!1);return t.Steps.forEach((function(e){u.choices.push({Value:e.Key,Name:e.Value})})),n?u.defaultValue=n:t.Steps.length>0&&(u.defaultValue=t.Steps[0].Key),o={component:{type:r.ChoiceDropdownComponent,updatePropertiesOnChange:!0,properties:{settings:u}}},Object(I.of)(o);case a.FormsConstants.FORM_ACTION_TYPE.SHOW_MESSAGE:var E=void 0,h=new f.TextAreaSettings("editorComponent",!1);h.required=!0,h.friendlyTitle=a.FormsConstants.MESSAGE;var T=[];return T.push(_.Validators.required),h.validators=_.Validators.compose(T),n?E=n:h.defaultValue=S.stringConstants.EMPTY_STRING,o={component:{type:m.TextAreaComponent,updatePropertiesOnChange:!0,properties:{settings:h,value:E}},cssClassList:"sf-row__col"},Object(I.of)(o);case a.FormsConstants.FORM_ACTION_TYPE.SEND_NOTIFICATION:var g=void 0,R=new D.TextAreaMultilineEmailSettings("editorComponent",!1);R.required=!0,R.friendlyTitle=a.FormsConstants.EMAIL_ADDRESS,R.instructionalText=a.FormsConstants.SEND_NOTIFICATION.TEXT_AREA.INSTRUCTIONAL_TEXT,R.placeholder=a.FormsConstants.SEND_NOTIFICATION.TEXT_AREA.PLACEHOLDER;var A=[];return A.push(_.Validators.required),A.push(O.VALIDATORS[O.VALIDATOR_NAMES.MULTILINE_EMAILS]()),R.validators=_.Validators.compose(A),n?g=n.split(",").join("\n"):R.defaultValue=S.stringConstants.EMPTY_STRING,o={component:{type:m.TextAreaComponent,updatePropertiesOnChange:!0,properties:{settings:R,value:g}},cssClassList:"sf-row__col"},Object(I.of)(o);case a.FormsConstants.FORM_ACTION_TYPE.GOTO:var y=new p.RelatedDataSettings("relatedDataComponent",!1);y.type=F.ENTITY_SET.PAGES,y.culture=t.Culture,y.allowMultiple=!1,y.displayMode=C.DISPLAY_MODE.INPUT,y.required=!0,y.title=a.FormsConstants.PAGE;var P=[];if(P.push(_.Validators.required),y.validators=_.Validators.compose(P),n){var N={itemKey:n,entityData:{metadata:this.metadataStore.getEntity(F.ENTITY_SET.PAGES),culture:t.Culture}};return new I.Observable((function(e){l.dynamicItemsService.getItem(N).subscribe((function(t){e.next(o={component:{type:d.RelatedDataComponent,updatePropertiesOnChange:!0,properties:{settings:y,value:[Object(v.cloneObject)(t.data)]}},cssClassList:"sf-row__col"})}),(function(t){e.next(o={component:{type:d.RelatedDataComponent,updatePropertiesOnChange:!0,properties:{settings:y,value:[Object(v.cloneObject)({Title:a.FormsConstants.SELECTED_PAGE_DOES_NOT_EXIST,NotFound:!0,icon:"ban",iconLook:"darker",inactive:!0})]}},cssClassList:"sf-row__col"})}))}))}return o={component:{type:d.RelatedDataComponent,updatePropertiesOnChange:!0,properties:{settings:y,value:[]}},cssClassList:"sf-row__col"},Object(I.of)(o);default:return o={component:{type:i.InputComponent}},Object(I.of)(o)}},e.prototype.getField=function(e,t){return e.Fields.find((function(e){return e.Id===t}))},e.prototype.getConditionFields=function(e){var t=[];return e.Fields.forEach((function(e){e.Type&&e.Operators&&e.Operators.length>0&&-1===a.FormsConstants.STATIC_FORM_FIELDS.indexOf(e.Type)&&t.push(e)})),t},e.prototype.getActionFields=function(e){var t=[];return e.Fields.forEach((function(e){e.Hideable&&t.push(e)})),t},e.ɵfac=function(t){return new(t||e)(o["ɵɵinject"](T.MetadataStore),o["ɵɵinject"](g.DynamicItemService))},e.ɵprov=o["ɵɵdefineInjectable"]({token:e,factory:e.ɵfac}),e}()},2257:function(e,t,n){"use strict";n.r(t),n.d(t,"TextAreaMultilineEmailSettings",(function(){return r}));var o=n(259),i=n(327),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.init=function(t){e.prototype.init.call(this,t)},t.prototype.getValidators=function(t){var n=e.prototype.getValidators.call(this,t);return n.push(i.VALIDATORS[i.VALIDATOR_NAMES.MULTILINE_EMAILS]()),n},t}(n(1663).TextAreaSettings)},2258:function(e,t,n){"use strict";n.r(t),n.d(t,"ActionCreateCompositeComponent",(function(){return v}));var o=n(259),i=n(229),r=n(1145),s=n(2256),a=n(1102),l=n(131),c=n(263),u=n(313),f=n(1144),m=n(261),p=n(351),d=n(347),C=n(352),E=["loader"];function h(e,t){if(1&e&&(i["ɵɵelementStart"](0,"div",11),i["ɵɵtext"](1),i["ɵɵelementEnd"]()),2&e){var n=i["ɵɵnextContext"](2);i["ɵɵadvance"](1),i["ɵɵtextInterpolate1"](" ",n.formFieldColumnData.component.properties.settings.instructionalText," ")}}function T(e,t){if(1&e&&i["ɵɵelement"](0,"sf-error",12),2&e){var n=i["ɵɵnextContext"](2);i["ɵɵproperty"]("messages",n.errorMessages)}}var g=function(e){return{"-has-errors":e}};function F(e,t){if(1&e){var n=i["ɵɵgetCurrentView"]();i["ɵɵelementStart"](0,"div",6),i["ɵɵelementStart"](1,"sf-component-loader",7,8),i["ɵɵlistener"]("componentInit",(function(e){return i["ɵɵrestoreView"](n),i["ɵɵnextContext"]().loaderInit(e)})),i["ɵɵelementEnd"](),i["ɵɵtemplate"](3,h,2,1,"div",9),i["ɵɵtemplate"](4,T,1,1,"sf-error",10),i["ɵɵelementEnd"]()}if(2&e){var o=i["ɵɵnextContext"]();i["ɵɵproperty"]("ngClass",o.formFieldColumnData.cssClassList),i["ɵɵadvance"](1),i["ɵɵproperty"]("ngClass",i["ɵɵpureFunction1"](5,g,o.showErrors&&o.errorMessages&&o.errorMessages.length>0))("componentData",o.formFieldColumnData.component),i["ɵɵadvance"](2),i["ɵɵproperty"]("ngIf",o.formFieldColumnData.component.properties.settings.instructionalText&&(!o.showErrors||!o.errorMessages||0===o.errorMessages.length)),i["ɵɵadvance"](1),i["ɵɵproperty"]("ngIf",o.showErrors&&o.errorMessages&&o.errorMessages.length>0)}}function I(e,t){if(1&e){var n=i["ɵɵgetCurrentView"]();i["ɵɵelementStart"](0,"span",13),i["ɵɵelementStart"](1,"sf-icon",14),i["ɵɵlistener"]("click",(function(){return i["ɵɵrestoreView"](n),i["ɵɵnextContext"]().onToggleTooltip()}))("keyup.enter",(function(){return i["ɵɵrestoreView"](n),i["ɵɵnextContext"]().onToggleTooltip()})),i["ɵɵelementEnd"](),i["ɵɵelementStart"](2,"sf-notification",15),i["ɵɵtext"](3),i["ɵɵelementEnd"](),i["ɵɵelementEnd"]()}if(2&e){var o=i["ɵɵnextContext"]();i["ɵɵclassProp"]("-dropped",o.droppedTooltip),i["ɵɵadvance"](2),i["ɵɵproperty"]("caption",o.formFieldColumnData.tooltip.title),i["ɵɵadvance"](1),i["ɵɵtextInterpolate1"](" ",o.formFieldColumnData.tooltip.message," ")}}function S(e,t){if(1&e){var n=i["ɵɵgetCurrentView"]();i["ɵɵelementStart"](0,"sf-icon",16),i["ɵɵlistener"]("click",(function(){return i["ɵɵrestoreView"](n),i["ɵɵnextContext"]().deleteAction()})),i["ɵɵelementEnd"]()}}var v=function(e){function t(t){var n=e.call(this)||this;return n.typeParserService=t,n.actionForDelete=new i.EventEmitter,n.showErrors=!1,n.formGroup=new u.FormGroup({}),n}return Object(o.__extends)(t,e),t.prototype.ngOnInit=function(){this.initActionFields()},t.prototype.loaderInit=function(e){var t=this,n=this;this.wrappedField=e,this.handleFocusChanges(),this.wrappedField.registerOnChange((function(e){t.processErrors(),e instanceof Array&&e.length>0?n.formRuleAction.Target=e[0].Id:n.formRuleAction.Target=e}))},t.prototype.formActionChanged=function(e){e&&(this.formRuleAction.Action=e,this.refreshDynamicComponent(null))},t.prototype.deleteAction=function(){this.actionForDelete.emit(this.formRuleAction)},t.prototype.isValid=function(){var e;this.formGroup.reset(),this.formGroup.setControl(this.wrappedField.settings.key,new u.FormControl(this.wrappedField.value,{validators:this.wrappedField.settings.validators})),this.formGroup.updateValueAndValidity(),e=this.formGroup.valid;var t=this.wrappedField.processErrors(this.formGroup.controls[this.wrappedField.settings.key].errors);return this.processErrors(t),e},t.prototype.processErrors=function(e){void 0===e&&(e=[]),this.errorMessages=[],this.showErrors=!1,e&&e.length>0&&(this.errorMessages=e,this.showErrors=!0)},t.prototype.onToggleTooltip=function(){this.droppedTooltip=!this.droppedTooltip},t.prototype.handleFocusChanges=function(){var e=this,t=this.wrappedField.focus$.subscribe((function(t){e.showErrors=!t}));this.registerSubscription(t)},t.prototype.initActionFields=function(){var e=this;this.formRuleAction&&(this.formActionsDropdownSettings=new r.ChoiceSettings("formActionsDropdown",!1),this.formDefinition.AvailableActions.forEach((function(t){e.formActionsDropdownSettings.choices.push({Value:t.Key,Name:t.Value})})),this.formActionsDropdownSettings.defaultValue=this.formRuleAction.Action,this.refreshDynamicComponent(this.formRuleAction.Target))},t.prototype.refreshDynamicComponent=function(e){var t=this;this.processErrors(),this.loader&&this.loader.destroy(this.formFieldColumnData.component),this.typeParserService.getActionComponentType(this.formRuleAction.Action,this.formDefinition,e).pipe(Object(l.first)()).subscribe((function(e){t.formFieldColumnData=e;var n=t.formFieldColumnData.component.properties.settings.defaultValue;null!==n&&(t.formRuleAction.Target=n.toString())}))},t.ɵfac=function(e){return new(e||t)(i["ɵɵdirectiveInject"](s.FormFieldTypesParserService))},t.ɵcmp=i["ɵɵdefineComponent"]({type:t,selectors:[["sf-action-create-composite"]],viewQuery:function(e,t){if(1&e&&i["ɵɵviewQuery"](E,!0),2&e){var n;i["ɵɵqueryRefresh"](n=i["ɵɵloadQuery"]())&&(t.loader=n.first)}},inputs:{formDefinition:"formDefinition",formRuleAction:"formRuleAction",canDelete:"canDelete"},outputs:{actionForDelete:"actionForDelete"},features:[i["ɵɵInheritDefinitionFeature"]],decls:6,vars:4,consts:[[1,"sf-row"],[1,"sf-row__col","-col-6","-sf-mr-xs"],[3,"settings","selectionChange"],["class","-sf-mr-3xs",3,"ngClass",4,"ngIf"],["class","-align-self-center sf-field__tooltip sf-tooltip -open-on-click",3,"-dropped",4,"ngIf"],["look","size-3xs sf-clickable","name","times","class","-sf-mt-3xs -sf-ml-auto",3,"click",4,"ngIf"],[1,"-sf-mr-3xs",3,"ngClass"],[1,"sf-field","-sf-mb-zero","-sf-pb-zero","-sf-pt-zero",3,"ngClass","componentData","componentInit"],["loader",""],["class","sf-field__hint -sf-mt-4xs -sf-txt-base",4,"ngIf"],["class","-sf-mt-4xs -sf-txt-base",3,"messages",4,"ngIf"],[1,"sf-field__hint","-sf-mt-4xs","-sf-txt-base"],[1,"-sf-mt-4xs","-sf-txt-base",3,"messages"],[1,"-align-self-center","sf-field__tooltip","sf-tooltip","-open-on-click"],["name","question-circle","look","size-xs sf-clickable","tabindex","0","aria-label","Show or hide fields information",3,"click","keyup.enter"],["look","tooltip narrow",1,"sf-tooltip__content",3,"caption"],["look","size-3xs sf-clickable","name","times",1,"-sf-mt-3xs","-sf-ml-auto",3,"click"]],template:function(e,t){1&e&&(i["ɵɵelementStart"](0,"div",0),i["ɵɵelementStart"](1,"div",1),i["ɵɵelementStart"](2,"sf-dropdown-choice",2),i["ɵɵlistener"]("selectionChange",(function(e){return t.formActionChanged(e)})),i["ɵɵelementEnd"](),i["ɵɵelementEnd"](),i["ɵɵtemplate"](3,F,5,7,"div",3),i["ɵɵtemplate"](4,I,4,4,"span",4),i["ɵɵtemplate"](5,S,1,0,"sf-icon",5),i["ɵɵelementEnd"]()),2&e&&(i["ɵɵadvance"](2),i["ɵɵproperty"]("settings",t.formActionsDropdownSettings),i["ɵɵadvance"](1),i["ɵɵproperty"]("ngIf",t.formFieldColumnData),i["ɵɵadvance"](1),i["ɵɵproperty"]("ngIf",t.formFieldColumnData&&t.formFieldColumnData.tooltip),i["ɵɵadvance"](1),i["ɵɵproperty"]("ngIf",t.canDelete))},directives:[f.ChoiceDropdownComponent,m.NgIf,m.NgClass,a.DynamicComponentLoaderComponent,p.ErrorComponent,d.SfIconComponent,C.NotificationComponent],encapsulation:2}),t}(c.RxBaseComponent)},2259:function(e,t,n){"use strict";n.r(t),n.d(t,"ConditionCreateCompositeComponent",(function(){return h}));var o=n(229),i=n(1145),r=n(2255),s=n(2256),a=n(1102),l=n(246),c=n(1239),u=n(245),f=n(1144),m=n(261),p=n(347),d=["loader"];function C(e,t){if(1&e){var n=o["ɵɵgetCurrentView"]();o["ɵɵelementStart"](0,"sf-component-loader",6,7),o["ɵɵlistener"]("componentInit",(function(e){return o["ɵɵrestoreView"](n),o["ɵɵnextContext"]().loaderInit(e)})),o["ɵɵelementEnd"]()}if(2&e){var i=o["ɵɵnextContext"]();o["ɵɵproperty"]("componentData",i.formFieldColumnData.component)("ngClass",i.formFieldColumnData.cssClassList)}}function E(e,t){if(1&e){var n=o["ɵɵgetCurrentView"]();o["ɵɵelementStart"](0,"sf-icon",8),o["ɵɵlistener"]("click",(function(){return o["ɵɵrestoreView"](n),o["ɵɵnextContext"]().deleteCondition()})),o["ɵɵelementEnd"]()}}var h=function(){function e(e){this.typeParserService=e,this.conditionForDelete=new o.EventEmitter}return e.prototype.ngOnInit=function(){this.initConditionFields()},e.prototype.formFieldChanged=function(e){if(this.formField=this.formDefinition.Fields.find((function(t){return t.Id===e})),this.formField){var t=this.formField.Operators.length>0?this.formField.Operators[0].Key:null;this.operatorsDropdownSettings.choices=this.setOperatorChoices(this.formField.Operators),this.operatorsDropdownSettings.defaultValue=t,this.formRuleCondition.Operator=t,this.formRuleCondition.Value=this.getDefaultFieldValue(),this.refreshDynamicComponent(this.formField,t,this.formRuleCondition.Value)}this.formRuleCondition.Id=e},e.prototype.conditionOperatorChanged=function(e){this.refreshDynamicComponent(this.formField,e,this.formRuleCondition.Value),this.formRuleCondition.Operator=e},e.prototype.deleteCondition=function(){this.conditionForDelete.emit(this.formRuleCondition)},e.prototype.loaderInit=function(e){var t=this;this.wrappedField=e,this.wrappedField.registerOnChange((function(e){if(t.loader.currentInstance instanceof c.DateTimePickerComponent)if(e){var n=new Date(e);t.formRuleCondition.Value=Object(u.convertDateToIsoDateTime)(n,r.FormsConstants.TIMEZONE_OFFSET)}else t.formRuleCondition.Value=e;else t.formRuleCondition.Value=e}))},e.prototype.initConditionFields=function(){var e=this;this.formRuleCondition&&(this.formFieldsDropdownSettings=new i.ChoiceSettings("formFieldsDropdown",!1),this.operatorsDropdownSettings=new i.ChoiceSettings("operatorsDropdown",!1),this.typeParserService.getConditionFields(this.formDefinition).forEach((function(t){e.formFieldsDropdownSettings.choices.push({Value:t.Id,Name:t.Title})})),this.formField=this.formDefinition.Fields.find((function(t){return t.Id===e.formRuleCondition.Id})),this.formField&&(this.formFieldsDropdownSettings.defaultValue=this.formRuleCondition.Id,this.operatorsDropdownSettings.choices=this.setOperatorChoices(this.formField.Operators),this.operatorsDropdownSettings.defaultValue=this.formRuleCondition.Operator,this.refreshDynamicComponent(this.formField,this.formRuleCondition.Operator,this.formRuleCondition.Value)))},e.prototype.refreshDynamicComponent=function(e,t,n){this.loader&&this.loader.destroy(this.formFieldColumnData.component),t===r.FormsConstants.CONDITION_OPERATORS.IsFilled||t===r.FormsConstants.CONDITION_OPERATORS.IsNotFilled?(this.formRuleCondition.Value=l.stringConstants.EMPTY_STRING,this.formFieldColumnData=this.typeParserService.getConditionComponentType({Type:null},null)):this.formFieldColumnData=this.typeParserService.getConditionComponentType(e,n)},e.prototype.setOperatorChoices=function(e){return e.map((function(e){return{Name:e.Value,Value:e.Key}}))},e.prototype.getDefaultFieldValue=function(){var e=l.stringConstants.EMPTY_STRING;return this.formField&&this.formField.Values&&this.formField.Values.length>0&&(e=this.formField.Values[0]),e},e.ɵfac=function(t){return new(t||e)(o["ɵɵdirectiveInject"](s.FormFieldTypesParserService))},e.ɵcmp=o["ɵɵdefineComponent"]({type:e,selectors:[["sf-condition-create-composite"]],viewQuery:function(e,t){if(1&e&&o["ɵɵviewQuery"](d,!0),2&e){var n;o["ɵɵqueryRefresh"](n=o["ɵɵloadQuery"]())&&(t.loader=n.first)}},inputs:{formDefinition:"formDefinition",formRuleCondition:"formRuleCondition",canDelete:"canDelete"},outputs:{conditionForDelete:"conditionForDelete"},decls:7,vars:4,consts:[[1,"sf-row"],[1,"sf-row__col","-col-6","-sf-mr-xs"],[1,"-sf-mr-xs","sf-row__col","-col-7",3,"settings","selectionChange"],[1,"sf-row__col",3,"settings","selectionChange"],["class","-sf-mr-3xs",3,"componentData","ngClass","componentInit",4,"ngIf"],["look","size-3xs sf-clickable","name","times","class","-sf-mt-3xs  -sf-ml-auto",3,"click",4,"ngIf"],[1,"-sf-mr-3xs",3,"componentData","ngClass","componentInit"],["loader",""],["look","size-3xs sf-clickable","name","times",1,"-sf-mt-3xs","-sf-ml-auto",3,"click"]],template:function(e,t){1&e&&(o["ɵɵelementStart"](0,"div",0),o["ɵɵelementStart"](1,"div",1),o["ɵɵelementStart"](2,"div",0),o["ɵɵelementStart"](3,"sf-dropdown-choice",2),o["ɵɵlistener"]("selectionChange",(function(e){return t.formFieldChanged(e)})),o["ɵɵelementEnd"](),o["ɵɵelementStart"](4,"sf-dropdown-choice",3),o["ɵɵlistener"]("selectionChange",(function(e){return t.conditionOperatorChanged(e)})),o["ɵɵelementEnd"](),o["ɵɵelementEnd"](),o["ɵɵelementEnd"](),o["ɵɵtemplate"](5,C,2,2,"sf-component-loader",4),o["ɵɵtemplate"](6,E,1,0,"sf-icon",5),o["ɵɵelementEnd"]()),2&e&&(o["ɵɵadvance"](3),o["ɵɵproperty"]("settings",t.formFieldsDropdownSettings),o["ɵɵadvance"](1),o["ɵɵproperty"]("settings",t.operatorsDropdownSettings),o["ɵɵadvance"](1),o["ɵɵproperty"]("ngIf",t.formFieldColumnData),o["ɵɵadvance"](1),o["ɵɵproperty"]("ngIf",t.canDelete))},directives:[f.ChoiceDropdownComponent,m.NgIf,a.DynamicComponentLoaderComponent,m.NgClass,p.SfIconComponent],encapsulation:2}),e}()},2260:function(e,t,n){"use strict";n.r(t),n.d(t,"ConditionColumnComponent",(function(){return m})),n.d(t,"GetConditionFieldTitlePipe",(function(){return p})),n.d(t,"GetConditionOperatorLabelPipe",(function(){return d})),n.d(t,"GetRuleOperatorLabelPipe",(function(){return C})),n.d(t,"GetConditionFieldValuePipe",(function(){return E}));var o=n(229),i=n(2255),r=n(2256),s=n(246),a=n(1105),l=n(1574),c=n(261);function u(e,t){if(1&e&&(o["ɵɵelementStart"](0,"span",1),o["ɵɵtext"](1),o["ɵɵpipe"](2,"sfGetRuleOperatorLabel"),o["ɵɵelementEnd"]()),2&e){var n=o["ɵɵnextContext"](2);o["ɵɵadvance"](1),o["ɵɵtextInterpolate1"](" ",o["ɵɵpipeBind1"](2,1,n.formRuleOperator),"")}}function f(e,t){if(1&e&&(o["ɵɵelementStart"](0,"div"),o["ɵɵelementStart"](1,"div"),o["ɵɵtext"](2),o["ɵɵpipe"](3,"sfGetConditionFieldTitle"),o["ɵɵelementStart"](4,"span",1),o["ɵɵtext"](5),o["ɵɵpipe"](6,"sfGetConditionOperatorLabel"),o["ɵɵelementEnd"](),o["ɵɵtext"](7),o["ɵɵpipe"](8,"sfGetConditionFieldValue"),o["ɵɵtemplate"](9,u,3,3,"span",2),o["ɵɵelementEnd"](),o["ɵɵelementEnd"]()),2&e){var n=t.$implicit,i=t.last,r=o["ɵɵnextContext"]();o["ɵɵadvance"](2),o["ɵɵtextInterpolate"](o["ɵɵpipeBind2"](3,4,n,r.formDefinition)),o["ɵɵadvance"](3),o["ɵɵtextInterpolate1"](" ",o["ɵɵpipeBind2"](6,7,n,r.formDefinition)," "),o["ɵɵadvance"](2),o["ɵɵtextInterpolate"](o["ɵɵpipeBind2"](8,10,n,r.formDefinition)),o["ɵɵadvance"](2),o["ɵɵproperty"]("ngIf",!i)}}var m=function(){function e(e){this.typeParserService=e}return e.ɵfac=function(t){return new(t||e)(o["ɵɵdirectiveInject"](r.FormFieldTypesParserService))},e.ɵcmp=o["ɵɵdefineComponent"]({type:e,selectors:[["sf-condition-column"]],inputs:{formRuleConditions:"formRuleConditions",formRuleOperator:"formRuleOperator",formDefinition:"formDefinition"},decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[1,"-sf-txt-hint"],["class","-sf-txt-hint",4,"ngIf"]],template:function(e,t){1&e&&o["ɵɵtemplate"](0,f,10,13,"div",0),2&e&&o["ɵɵproperty"]("ngForOf",t.formRuleConditions)},directives:function(){return[c.NgForOf,c.NgIf]},pipes:function(){return[p,d,E,C]},encapsulation:2}),e}(),p=function(){function e(e){this.typeParserService=e}return e.prototype.transform=function(e,t){var n=this.typeParserService.getField(t,e.Id);return n?n.Title:s.stringConstants.EMPTY_STRING},e.ɵfac=function(t){return new(t||e)(o["ɵɵdirectiveInject"](r.FormFieldTypesParserService))},e.ɵpipe=o["ɵɵdefinePipe"]({name:"sfGetConditionFieldTitle",type:e,pure:!0}),e}(),d=function(){function e(e){this.typeParserService=e}return e.prototype.transform=function(e,t){var n=this.typeParserService.getField(t,e.Id);if(n){var o=n.Operators.find((function(t){return t.Key===e.Operator}));if(o)return o.Value}return s.stringConstants.EMPTY_STRING},e.ɵfac=function(t){return new(t||e)(o["ɵɵdirectiveInject"](r.FormFieldTypesParserService))},e.ɵpipe=o["ɵɵdefinePipe"]({name:"sfGetConditionOperatorLabel",type:e,pure:!0}),e}(),C=function(){function e(){}return e.prototype.transform=function(e){return i.FormRuleOperatorList[e]},e.ɵfac=function(t){return new(t||e)},e.ɵpipe=o["ɵɵdefinePipe"]({name:"sfGetRuleOperatorLabel",type:e,pure:!0}),e}(),E=function(){function e(e){this.typeParserService=e,this.relativeDatePipe=new a.RelativeDatePipe,this.isoWeekDatesPipe=new l.IsoWeekDatesPipe}return e.prototype.transform=function(e,t){var n=this.typeParserService.getField(t,e.Id);if(n&&n.InputType&&e.Value&&e.Value.trim()!==s.stringConstants.EMPTY_STRING)switch(n.InputType){case i.FormsConstants.TEXT_INPUT_TYPE.DATE:return this.relativeDatePipe.transform(e.Value,null,i.FormsConstants.TIMEZONE_OFFSET);case i.FormsConstants.TEXT_INPUT_TYPE.MONTH:return this.relativeDatePipe.transform(e.Value,a.RelativeDatePipe.MONTH_AND_YEAR,i.FormsConstants.TIMEZONE_OFFSET);case i.FormsConstants.TEXT_INPUT_TYPE.TIME:return this.relativeDatePipe.transform(e.Value,a.RelativeDatePipe.TIME,i.FormsConstants.TIMEZONE_OFFSET);case i.FormsConstants.TEXT_INPUT_TYPE.DATE_TIME_LOCAL:return this.relativeDatePipe.transform(e.Value,a.RelativeDatePipe.FULL_DATE_SHORT_MONTH_AND_TIME,i.FormsConstants.TIMEZONE_OFFSET);case i.FormsConstants.TEXT_INPUT_TYPE.WEEK:return this.isoWeekDatesPipe.transform(e.Value);default:return e.Value}return e.Value},e.ɵfac=function(t){return new(t||e)(o["ɵɵdirectiveInject"](r.FormFieldTypesParserService))},e.ɵpipe=o["ɵɵdefinePipe"]({name:"sfGetConditionFieldValue",type:e,pure:!0}),e}()},2261:function(e,t,n){"use strict";n.r(t),n.d(t,"ActionColumnComponent",(function(){return c}));var o=n(229),i=n(261),r=n(2262),s=n(360),a=n(2263);function l(e,t){if(1&e&&(o["ɵɵelementStart"](0,"div"),o["ɵɵelementStart"](1,"span",1,2),o["ɵɵtext"](3),o["ɵɵpipe"](4,"sfTrimText"),o["ɵɵelementEnd"](),o["ɵɵelementStart"](5,"span",3,4),o["ɵɵtext"](7),o["ɵɵelementEnd"](),o["ɵɵelementEnd"]()),2&e){var n=t.$implicit,i=o["ɵɵreference"](2),r=o["ɵɵreference"](6),s=o["ɵɵnextContext"]();o["ɵɵadvance"](1),o["ɵɵproperty"]("formRuleAction",n)("formDefinition",s.formDefinition)("isFormField",!1),o["ɵɵadvance"](2),o["ɵɵtextInterpolate1"](" ",o["ɵɵpipeBind2"](4,9,i.actionColumnData.title,"...")," "),o["ɵɵadvance"](2),o["ɵɵproperty"]("formRuleAction",n)("formDefinition",s.formDefinition)("ngClass",r.actionColumnData.cssClassList)("trimLength",50),o["ɵɵadvance"](2),o["ɵɵtextInterpolate1"](" ",r.actionColumnData.title," ")}}var c=function(){function e(){}return e.ɵfac=function(t){return new(t||e)},e.ɵcmp=o["ɵɵdefineComponent"]({type:e,selectors:[["sf-action-column"]],inputs:{formRuleActions:"formRuleActions",formDefinition:"formDefinition"},decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],["sfFormActionColumn","",1,"-sf-txt-hint",3,"formRuleAction","formDefinition","isFormField"],["formActionColumn","sfFormActionColumn"],["sfFormActionColumn","","sfTextOverflow","",3,"formRuleAction","formDefinition","ngClass","trimLength"],["formFieldActionColumn","sfFormActionColumn"]],template:function(e,t){1&e&&o["ɵɵtemplate"](0,l,8,12,"div",0),2&e&&o["ɵɵproperty"]("ngForOf",t.formRuleActions)},directives:[i.NgForOf,r.FormActionColumnDirective,s.TextOverflowDirective,i.NgClass],pipes:[a.TrimTextPipe],encapsulation:2}),e}()},2262:function(e,t,n){"use strict";n.r(t),n.d(t,"FormActionColumnDirective",(function(){return u}));var o=n(229),i=n(2255),r=n(2256),s=n(246),a=n(268),l=n(307),c=n(256),u=function(){function e(e,t,n){this.typeParserService=e,this.metadataStore=t,this.dynamicItemsService=n,this.isFormField=!0,this.actionColumnData={title:s.stringConstants.EMPTY_STRING}}return e.prototype.ngOnInit=function(){this.setFieldActionData()},e.prototype.setFieldActionData=function(){this.isFormField?this.getActionFieldData():this.getActionData()},e.prototype.getActionData=function(){var e=this,t=this.formDefinition.AvailableActions.find((function(t){return t.Key===e.formRuleAction.Action}));this.actionColumnData.title=this.formRuleAction.Action,t&&(this.actionColumnData.title=t.Value)},e.prototype.getActionFieldData=function(){var e=this;switch(this.formRuleAction.Action){case i.FormsConstants.FORM_ACTION_TYPE.SHOW:case i.FormsConstants.FORM_ACTION_TYPE.HIDE:var t=this.typeParserService.getField(this.formDefinition,this.formRuleAction.Target);t&&(this.actionColumnData.title=t.Title);break;case i.FormsConstants.FORM_ACTION_TYPE.SKIP:var n=this.formDefinition.Steps?this.formDefinition.Steps.find((function(t){return t.Key.toString()===e.formRuleAction.Target})):null;n&&(this.actionColumnData.title=n.Value);break;case i.FormsConstants.FORM_ACTION_TYPE.GOTO:var o=this.formRuleAction.Target;if(o){var r={itemKey:o,entityData:{metadata:this.metadataStore.getEntity(c.ENTITY_SET.PAGES),culture:this.formDefinition.Culture}};this.dynamicItemsService.getItem(r).subscribe((function(t){e.actionColumnData.title=t.data.Title}),(function(t){e.actionColumnData={title:i.FormsConstants.PAGE_DOES_NOT_EXIST,cssClassList:"-sf-txt-failure"}}))}break;case i.FormsConstants.FORM_ACTION_TYPE.SEND_NOTIFICATION:this.actionColumnData.title=this.formRuleAction.Target.trim().split(",").filter((function(e){return e!==s.stringConstants.EMPTY_STRING})).map((function(e){return e.trim()})).join(""+s.stringConstants.COMMA+s.stringConstants.INTERVAL);break;default:this.actionColumnData.title=this.formRuleAction.Target}},e.ɵfac=function(t){return new(t||e)(o["ɵɵdirectiveInject"](r.FormFieldTypesParserService),o["ɵɵdirectiveInject"](a.MetadataStore),o["ɵɵdirectiveInject"](l.DynamicItemService))},e.ɵdir=o["ɵɵdefineDirective"]({type:e,selectors:[["","sfFormActionColumn",""]],inputs:{formRuleAction:"formRuleAction",formDefinition:"formDefinition",isFormField:"isFormField"},exportAs:["sfFormActionColumn"]}),e}()},2263:function(e,t,n){"use strict";n.r(t),n.d(t,"TrimTextPipe",(function(){return r}));var o=n(229),i=n(246),r=function(){function e(){}return e.prototype.transform=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!e)return i.stringConstants.EMPTY_STRING;var o=e,r=t[0]?t[0].trim():i.stringConstants.EMPTY_STRING;return r&&r!==i.stringConstants.EMPTY_STRING&&(r=r.replace(i.regexConstants.ESCAPE_RESERVED_CHARACTERS_PATTERN,"\\"+i.regexConstants.DOLLAR+i.stringConstants.AMPERSAND),o=(o=o.replace(new RegExp(i.regexConstants.CARET+r,i.regexConstants.IGNORE_CASE),i.stringConstants.EMPTY_STRING)).replace(new RegExp(r+i.regexConstants.DOLLAR,i.regexConstants.IGNORE_CASE),i.stringConstants.EMPTY_STRING)),o},e.ɵfac=function(t){return new(t||e)},e.ɵpipe=o["ɵɵdefinePipe"]({name:"sfTrimText",type:e,pure:!0}),e}()},2264:function(e,t,n){"use strict";n.r(t),n.d(t,"FormsEditIntegratedComponent",(function(){return l}));var o=n(229),i=n(261),r=n(260),s=n(2255),a=n(396),l=function(){function e(e,t){this.document=e,this.router=t}return e.prototype.ngOnInit=function(){var e=this;this.document.addEventListener(s.FormsConstants.ROUTES.SITEFINITY_OLD_BACKEND_EDIT_FORM_RULE_EVENT_NAME,(function(t){e.formId=t.detail.controlId,e.culture=t.detail.culture,e.router.navigate([a.ROUTE_PATHS.CONTENT,a.ROUTE_PATHS_NO_PREFIX.FORMS,s.FormsConstants.ROUTES.RULES],{queryParams:{id:e.formId,culture:e.culture}})}))},e.ɵfac=function(t){return new(t||e)(o["ɵɵdirectiveInject"](i.DOCUMENT),o["ɵɵdirectiveInject"](r.Router))},e.ɵcmp=o["ɵɵdefineComponent"]({type:e,selectors:[["sf-forms-edit-integrated"]],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}()}}]);